# API YaMDb

## Описание:
**YaMDb** — это API-сервис для сбора отзывов пользователей на произведения различных категорий, таких как книги, фильмы и музыка. Произведения в системе не хранятся. Пользователи могут:
- Оставлять текстовые отзывы;
- Ставить оценки от 1 до 10 (формируется средний рейтинг произведения);
- Комментировать отзывы других пользователей.

Произведения разделены на категории: "Книги", "Фильмы", "Музыка" и др. Для произведений можно назначить жанры, например, "Фантастика" или "Рок". Управление категориями, жанрами и произведениями доступно только администраторам.

---

## Технологии:
- **Python** 3.9
- **Django** 3.2
- **Django REST Framework (DRF)** 3.12
- **Simple-JWT** для аутентификации

## Установка и настройка

1. **Клонируйте репозиторий**:
   ```bash
   git clone git@github.com:skhfh/api_yamdb.git
   cd api_yamdb
   ```

2. **Создайте виртуальное окружение и активируйте его**:
   ```bash
   python -m venv venv
   source  venv\Scripts\activate  # Для Linux используйте venv/bin/activate
   ```

3. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Выполните миграции**:
   ```bash
   python manage.py migrate
   ```

5. **(Опционально) Заполните базу данных тестовыми данными**:
   ```bash
   python manage.py csv-in-bd
   ```

6. **Создайте суперпользователя и поменяйте ему роль на admin (в админке)**:
   ```bash
   python manage.py createsuperuser
   ```

7. **Запустите сервер разработки**:
   ```bash
   python manage.py runserver
   ```

8. **Документация API** доступна по адресу: http://127.0.0.1:8000/redoc/

---
## Пользовательские роли и права доступа

- **Анонимный пользователь (Anonymous)**  
  Может:
  - Просматривать описания произведений.
  - Читать отзывы и комментарии.

- **Аутентифицированный пользователь (User)**  
  Может всё, что Аноним, а также:
  - Публиковать отзывы и ставить оценки произведениям.  
  - Комментировать отзывы.  
  - Редактировать и удалять свои отзывы, комментарии и оценки.  
  - Эта роль присваивается автоматически при регистрации.

- **Модератор (Moderator)**  
  Имеет права пользователя, а также может:
  - Удалять и редактировать любые отзывы и комментарии.

- **Администратор (Admin)**  
  Полный доступ к управлению проектом.  
  Может:
  - Создавать, редактировать и удалять произведения, категории, жанры.
  - Управлять пользователями и назначать им роли.

- **Суперпользователь (Superuser)**  
  Обладает всеми правами администратора.  
  Может работать с системой через админ-зону Django.


## Самостоятельная регистрация новых пользователей

1. Пользователь отправляет **POST-запрос** на эндпоинт:  
   ```/api/v1/auth/signup/```  
   Параметры запроса:  
   - `email`: адрес электронной почты пользователя.  
   - `username`: имя пользователя.  

2. Сервис **YaMDb** отправляет на указанный email письмо с кодом подтверждения (**confirmation_code**).

3. Пользователь отправляет **POST-запрос** на эндпоинт:  
   ```/api/v1/auth/token/```  
   Параметры запроса:  
   - `username`: имя пользователя.  
   - `confirmation_code`: код подтверждения из письма.  

4. В ответ на запрос пользователь получает **JWT-токен**.  

5. После получения токена пользователь может:  
   - Выполнять запросы к API, передавая токен в заголовке `Authorization: Bearer <token>`.  
   - Отправить **PATCH-запрос** на эндпоинт:  
     ```/api/v1/users/me/```  
     и заполнить свой профиль (подробности полей доступны в документации API).  


## Создание пользователя администратором

1. Администратор может создать нового пользователя:
   - Через админ-зону Django.  
   - Или через **POST-запрос** на эндпоинт:  
     ```/api/v1/users/```  
     (описание полей для создания пользователя доступно в документации).  

2. После создания учетной записи пользователю необходимо:  
   - Отправить свой email и username на эндпоинт:  
     ```/api/v1/auth/signup/```  
     Сервис YaMDb отправит письмо с кодом подтверждения (**confirmation_code**) на указанный email.  

3. Пользователь отправляет **POST-запрос** на эндпоинт:  
   ```/api/v1/auth/token/```  
   Параметры запроса:  
   - `username`: имя пользователя.  
   - `confirmation_code`: код подтверждения из письма.  

4. В ответ пользователь получает **JWT-токен**, как и при самостоятельной регистрации.  

Теперь пользователь может использовать токен для работы с API. 


## Примеры запросов

- **Получение списка всех произведений**:
`GET /api/v1/titles/`

- **Добавление нового отзыва**:
`POST /api/v1/titles/{title_id}/reviews/`

Пример тела запроса:
```json
  {
    "text": "Отличное произведение!",
    "score": 9
  }
```
- **Получение комментариев к отзыву**:
  ```GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/```

---
#### Авторы проекта:
- [Максим Давлеев](https://github.com/Snork41)
- [Светлана Фадеева](https://github.com/svetlanaalefadeeva)
- [Шамиль Хамидуллин](https://github.com/skhfh)
